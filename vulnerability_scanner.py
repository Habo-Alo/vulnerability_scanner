from scapy.all import IP, TCP, sr1

def vulnerability_scan(target_ip, port):
    # Craft the TCP SYN packet
    packet = IP(dst=target_ip) / TCP(dport=port, flags="S")

    # Send the packet and capture the response
    response = sr1(packet, timeout=3, verbose=0)

    # Check the response for open/closed ports
    if response is not None:
        if response.haslayer(TCP) and response[TCP].flags == "SA":
            return f"Port {port} is open."
        else:
            return f"Port {port} is closed."
    else:
        return f"Port {port} is filtered."

# Example usage: scanning port 80 on the target IP
target_ip = "192.168.1.100"
port = 80
scan_result = vulnerability_scan(target_ip, port)

# Display the scan result
print(scan_result)


